(function(){var e,t,i,o,a,n,s;t=this,t.AdForm=function(){return this.init()},AdForm.prototype.init=function(){return $("#locations_from_list").length>0&&$(".location-form-for-ad").hide(),$("#ad-block").length&&!$("#ad-block").height()&&$("#wrap").append('<div class="blocking-notification alert alert-dismissible alert-warning" role="alert"><button type="button" class="close" data-dismiss="alert">\xd7</button><h5>'+gon.vars.adblock_warning+"</h5><p>"+gon.vars.adblock_browser+"<br />"+gon.vars.adblock_affecting+"</p><p>"+gon.vars.adblock_turnoff+"</p></div>"),$("#ad-block").remove(),e($("#items .selectpicker-items")),$("#new_ad").submit(function(){var e;return e=$("#ad_image").val(),null!==e&&""!==e?$("#upload-in-progress").html("<i>"+gon.vars.new_image_uploading+"</i>"):void 0}),$("#items a.add_fields").data("association-insertion-position","before").data("association-insertion-node","this"),$("#items").on("cocoon:after-insert",function(){return $(".ad-item-fields a.add_fields").data("association-insertion-position","before").data("association-insertion-node","this"),$(".selectpicker").selectpicker("refresh"),e($("#items .selectpicker-items")),$(".ad-item-fields").on("cocoon:after-insert",function(){return $(this).children(".item_from_list").remove(),$(this).children("a.add_fields").hide()})}),$(".ad-item-fields").bind("cocoon:after-insert",function(e){return e.stopPropagation(),$(this).find(".item_from_list").remove(),$(this).find("a.add_fields").hide(),$(".selectpicker").selectpicker("refresh")}),"undefined"!=typeof districts_bounds&&o(districts_bounds,leaf.map),$("#ad-edit-form").submit(function(){var e;return e=$("#ad_image").val(),null!==e&&""!==e?$("#upload-in-progress").html("<i>"+gon.vars.new_image_uploading+"</i>"):void 0}),$(".add-new-location").click(function(){return $(".location-form-for-ad").show(),$(".add-new-location").hide(),$(".location-form-for-ad :input").attr("disabled",!1),$("#locations_from_list :input").attr("disabled",!0)}),$(".remove-new-location").click(function(){return $(".location-form-for-ad").hide(),$(".add-new-location").show(),$(".location-form-for-ad :input").attr("disabled",!0),$("#locations_from_list :input").attr("disabled",!1)})},e=function(e){e.selectpicker({liveSearch:!0}).ajaxSelectPicker({ajax:{url:"/getItems",type:"GET",dataType:"json",data:function(){var e;return e={item:"{{{q}}}",type:"search_items"}}},locale:{emptyTitle:gon.vars.search_for_items,statusInitialized:gon.vars.start_typing_item,statusNoResults:gon.vars.no_result_create_item},preprocessData:function(e){var t,i,o,a;for(o=[],a=e.length,t=0;a>t;)i=e[t],o.push({value:i.id,text:i.value,disable:!1}),t++;return o},preserveSelected:!1})},o=function(e,t){return $("#map").length>0&&($(".location_type_exact").click(function(){return i(),n()}),$(".location_type_exact").is(":checked")&&n(),$(".location_type_postal_code").click(function(){return i(),s()}),$(".location_type_postal_code").is(":checked")&&s(),$(".location_type_district").click(function(){return i(),a()}),$(".location_type_district").is(":checked")&&a()),$(".location_postal_code").focusout(function(){var e,t,i,o;return $(".location_type_postal_code").is(":checked")&&(e=void 0,i=void 0,t=$(".location_type_postal_code").val(),o=$(".location_postal_code").val(),"undefined"==typeof e&&"undefined"==typeof i)?$.get("/user/getAreaSettings",{},function(i){var a;return null!==i.code&&null!==i.area&&(e=i.area,t.length>=e)?(a=o.substring(0,e),$("#postal_code_notification").html("<i>"+gon.vars.area_show_up+"'"+a+"'</i>")):void 0}):void 0}),$(".help-message").popover(),find_geocodes()},a=function(){var e,t,i;return $(".exact_location_section").addClass("hide"),$("#postal_code_section").addClass("hide"),$("#district_section").removeClass("hide"),$("#map_notification_postal_code_only").addClass("hide"),$("#map_notification_exact").addClass("hide"),markers.location_marker_type="area",leaf.map.off("click",onMapClickLocation),$("#map_notification").addClass("hide"),t=$(".district_dropdown option:selected").val(),i=$(".district_dropdown option:selected").text(),e=districts_bounds[t],leaf.show_single_district(i,e),$("#district_section").on("change",".district_dropdown",function(){return t=$(".district_dropdown option:selected").val(),i=$(".district_dropdown option:selected").text(),e=districts_bounds[t],leaf.show_single_district(i,e)}).change()},i=function(){return null!==markers.new_marker&&leaf.map.removeLayer(markers.new_marker),null!==markers.selected_area&&leaf.map.removeLayer(markers.selected_area),null!==markers.postal_code_circle?leaf.map.removeLayer(markers.postal_code_circle):void 0},n=function(){return $("#postal_code_section").removeClass("hide"),$("#district_section").addClass("hide"),$(".exact_location_section").removeClass("hide"),markers.location_marker_type="exact",leaf.map.on("click",onMapClickLocation),$("#map_notification_postal_code_only").addClass("hide"),$("#map_notification_exact").removeClass("hide")},s=function(){return $(".exact_location_section").addClass("hide"),$("#district_section").addClass("hide"),$("#postal_code_section").removeClass("hide"),markers.location_marker_type="area",leaf.map.on("click",onMapClickLocation),$("#map_notification_postal_code_only").removeClass("hide"),$("#map_notification_exact").addClass("hide")}}).call(this);