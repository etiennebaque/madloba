(function(){var e,t;e=this,e.NavigationBar=function(){return this.searchedAdItems=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/getItems?item=QUERY&type=search_ad_items",wildcard:"QUERY"}}),this.searchedAdItems.clearPrefetchCache(),this.searchedAdItems.initialize(),this.init()},NavigationBar.prototype.init=function(){var e;return e=this,$("#searchFormId input").keypress(function(t){return 13===t.which?(t.preventDefault(),e.getLocationsPropositions()):void 0}),$("#navbar-up-link").click(function(){return $("html, body").animate({scrollTop:0},1e3)}),t(),$(window).on("scroll",function(){return t()}),$("#btn-form-search").click(function(){return e.getLocationsPropositions()}),$("#popover").popover({html:!0,placement:"bottom",title:function(){return $("#popover-head").html()},content:function(){return $("#popover-content").html()}}),$("#item").typeahead(null,{name:"item-search",display:"value",source:e.searchedAdItems}),$("#q").change(function(){return e.searchedAdItems.remote.url="/getItems?item=QUERY&type=search_ad_items&q="+$("#q").val(),$("#item").val("")}).change()},t=function(){var e;return e=$(window).scrollTop(),0>=e?$("#navbar-up-link").hide():$("#navbar-up-link").show()},NavigationBar.prototype.getLocationsPropositions=function(){var e;return""!==$("#location").val()?(e=$("#location").val(),$.ajax({url:"/getNominatimLocationResponses",global:!1,type:"GET",data:{location:e},cache:!1,beforeSend:function(e){e.setRequestHeader("Accept","application/json"),e.setRequestHeader("Content-Type","application/json"),$("#btn-form-search").html("Loading...")},success:function(e){var t,o,n,a,r,i,l;if(n="",null!==e&&e.length>0)if("undefined"!=typeof e[0].error_key)$("#search_error_message").html("<strong>"+e[0].error_key+"</strong>");else{for(n="<p>Choose one of the following available locations</p><ul></ul>",o=$("#item").val(),i=$("#q").val(),t=0;t<e.length;)r=e[t],l="/search?lat="+r.lat+"&lon="+r.lon+"&loc="+r.display_name,""!==o&&(l=l+"&item="+o),""!==i&&(l=l+"&q="+i),n=n+"<li><a href='"+encodeURI(l)+"'>"+r.display_name+"</a></li>",t++;n+="</ul>",$("#modal-body-id").html(n),a={backdrop:"static",show:"true"},$("#basicModal").modal(a)}return $("#btn-form-search").html("Search")}})):""!==$("#item").val()||""!==$("#user_action").val()?$("#searchFormId").submit():void 0}}).call(this);